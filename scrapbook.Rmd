---
title: "R Notebook"
output: html_notebook
---


```{r}
# Libraries
library(ggplot2)
library(dplyr)
library(dbplyr)
source('./tokenizer/helpers/database_helper.R')

df <- db_connect(path = './data/ngrams/ngrams.sqlite') %>% 
  tbl('all_ngrams') %>% 
  as.data.frame()

res <- df %>% 
  filter(ngram %in% c("injustice", "equal rights", "discrimination"))

# Plot
  # build line plot
  plot <- res %>%
    group_by(year) %>%
    ggplot(aes(
      x = year,
      y = log(freq, base = 10),
      group = ngram,
      color = ngram
    )) +
    geom_smooth(method = "loess", se = FALSE)
  
  # Set axis styles
  plot <- plot + theme(
    axis.text.x = element_text(
      size = 14
    ),
    axis.title.x = element_text(
      color = "darkgrey",
      size = 12,
      face = "bold"
    ),
    axis.title.y = element_text(
      color = "darkgrey",
      size = 12,
      face = "bold"
    )
  )
  
  # Set axis labels
  plot <- plot +
    ylab('Log ( frequency of word per year )')

plot

```


```{r}
library(dplyr)
library(dbplyr)
source('./ngram_app/helpers/database_helper.R')
source('./ngram_app/helpers/image_helper.R')

con <- db_connect(path = './data/ngrams/ngrams.sqlite')

res <- db_select_first_corpus_with_ngram(con, 'all_corpuses', 'climate change', order = 'desc') %>% 
  as.data.frame()

print(res$president_name %>% name_to_url())

```